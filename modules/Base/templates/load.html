/* Titre de la page : création/modification/duplication d'une notice (de type xxxx) */<div class="titre">    <switch test="{$this->method}">        <case test="actionNew">Création</case>        <case test="actionLoad">Modification</case>        <case test="actionDuplicate">Duplication</case>    </switch>        d'une notice        <if test="{!Config::get('allfields',false)}">        <opt>de type $Type</opt>    </if></div><div class="texte">    /* Lien vers le formulaire de saisie comprenant tous les champs */    <if test="{!Config::get('allfields',false)}">    	<if test="{User::hasAccess('AdminBase')}">    	    <if test="{$REF > 0}"> /* on ne propose pas le lien si on est en train de créer ou de dupliquer une nouvelle notice */     	        <p><a href="LoadFull?REF=$REF" title="Saisie de la notice avec tous les champs"><span>Saisie de la notice avec tous les champs</span></a></p>    	    </if>    	</if>    </if>        <p><strong>Les zones encadrées de rouge sont des zones obligatoires.</strong></p>        <form method="post" action="Save" class="form load">                /* Boutons Enregistrer, Supprimer, Doublons potentiels */        <div class="buttons">            <def name="deletelink" value="{Routing::linkFor('ConfirmDelete?REF='.$REF)}" />            <button test="{$REF!=0 AND User::hasAccess('AdminBase')}" type="button" onclick="window.location.replace('$deletelink');" class="reset">Supprimer</button>            <button test="{Config::get('nodedupbutton') !== true}" type="button" onclick="checkDuplicate();" class="reset">Doublons potentiels</button>            <submit label="Enregistrer" class="submit" />        </div>/*             /* Liste des doublons potentiels */        <div id="DuplicatesContainer">            <button type="button" onclick="jQuery('#DuplicatesContainer').hide('slow')">Fermer</button>            <div id="Duplicates"></div>        </div>            /* Paramètres à passer au formulaire */        <hidden name="REF" value="$REF" />        <hidden test="{!is_null($Type) and !Config::get('allfields',false)}" name="Type" value="$Type" />                                /* Version en minuscules du type de la notice        Les documents de type Mémoire et Thèse ont le même masque de saisie */        <def name="TypeMinu" value="{strtolower($Type)==='thèse' ? 'mémoire' : strtolower($Type)}" />                /* On crée un pseudo type "allfields" pour la modification avec tous les champs */        <if test="{Config::get('allfields',false)}">            <def name="TypeMinu" value="allfields" />        </if>                /* Contenu spécifique à chaque type de document */        <switch test="$TypeMinu">                /* TODO : factoriser le switch : Congrès et Livre presque identiques */                    <case test="article">                <AutTit titLabel="Titre de l'article" />                <Date />                <MentionsBib pageName="PdPf" pageLabel="Page début-fin" />                <Periodique />                <ResuIndexation />                <Lien />                <ProdFich />                <Statut />                <script type="text/javascript">ctrlInitialize("ControlsArticle");</script>                  </case>                        <case test="congrès">                <AutTit titLabel="Titre du document" />                <Congres mandatory="{true}" />    			<Date />                <MentionsBib />                <fieldset label="Edition">                    <div>                        <text name="Edit" value="{implode('/',(array)$Edit)}" rows="1" label="Editeur(s)" class="fullwidth autoheight mandatory" />                        <help name="Edit" />                    </div>                    <div>                        <text name="Lieu" value="{implode('/',(array)$Lieu)}" rows="1" label="Lieu d'édition" class="fullwidth autoheight mandatory" />                        <help name="Lieu" />                    </div>                    <ColReed />                </fieldset>                <IsbnIssn label="ISBN / ISSN" />                <ResuIndexation />                <Lien />                <Loc />                <ProdFich />                <Statut />                <script type="text/javascript">ctrlInitialize("ControlsCongres");</script>            </case>                        <case test="livre">                <AutTit titLabel="Titre du document" />                <Congres />    			<Date />                <MentionsBib />                <fieldset label="Edition">                    <div>                        <text name="Edit" value="{implode('/',(array)$Edit)}" rows="1" label="Editeur" class="fullwidth autoheight mandatory" />                        <help name="Edit" />                    </div>                    <div>                        <text name="Lieu" value="{implode('/',(array)$Lieu)}" rows="1" label="Lieu d'édition" class="fullwidth autoheight mandatory" />                        <help name="Lieu" />                    </div>    				<ColReed />                </fieldset>                <IsbnIssn label="ISBN / ISSN" />                <ResuIndexation />                <Lien />                <Loc />                <ProdFich />                <Statut />                <script type="text/javascript">ctrlInitialize("ControlsLivre");</script>                    </case>                /* Masque de saisie identique pour les mémoires et les thèses */             <case test="mémoire">                <AutTit />                <fieldset label="Spécialité du diplôme">                    <text name="DipSpe" rows="1" class="fullwidth autoheight mandatory" />                    <help name="DipSpe" />                </fieldset>                <fieldset label="Edition">                    <div>                        <text name="Edit" value="{implode('/',(array)$Edit)}" rows="1" label="Institution morale de rattachement" class="fullwidth autoheight mandatory" />                        <help name="Edit" />                    </div>                    <div>                        <text name="Lieu" value="{implode('/',(array)$Lieu)}" rows="1" label="Lieu d'édition ou de soutenance" class="fullwidth autoheight mandatory" />                        <help name="Lieu" />                    </div>                </fieldset>                <MentionsBib />                <fieldset label="Année de soutenance">                    <text name="Date" class="fullwidth mandatory" />                    <help name="Date" />                </fieldset>                <ResuIndexation />                <Lien />                <Loc />                <ProdFich />                <Statut />                <script type="text/javascript">ctrlInitialize("ControlsMemoire");</script>            </case>         		 <case test="multimédia">                 <AutTit titLabel="Titre du document" />                 			<Date />				                              <fieldset label="Edition">                    <div>                        <text name="Edit" value="{implode('/',(array)$Edit)}" rows="1" label="Editeur" class="fullwidth autoheight mandatory" />                        <help name="Edit" />                    </div>                    <div>                        <text name="Lieu" value="{implode('/',(array)$Lieu)}" rows="1" label="Lieu d'édition" class="fullwidth autoheight mandatory" />                        <help name="Lieu" />											</div> 																                </fieldset>				/*  27012012 Voir si rajout ISBN/ISSN selon identifiants utilisés */				<ResuIndexation />				<fieldset label="Support du document multimédia">					<fill values="$Support"><radiolist name="Support" src="new TextTable($this->path.'tables/support.txt')" class="mandatory" /></fill>				</fieldset>					                <fieldset label="Notes">                    <text name="Notes" rows="1" class="fullwidth autoheight" />                    <help name="Notes" />                </fieldset>				                <Lien />                <Loc />                <ProdFich />                <Statut />					                <script type="text/javascript">ctrlInitialize("ControlsMultimedia");</script>                    </case>            <case test="périodique">                <fieldset label="Titre du périodique">                    <text name="Rev" rows="1" class="fullwidth autoheight mandatory" />                    <help name="Rev" />                </fieldset>                <fieldset label="Date de vie et de mort">                    <text name="ViePerio" class="fullwidth mandatory" />                    <help name="ViePerio" />                </fieldset>                <fieldset label="Etat de la collection">                    <text name="EtatCol" value="{implode('/',(array)$EtatCol)}" rows="1" class="fullwidth autoheight mandatory" />                    <help name="EtatCol" />                </fieldset>                <IsbnIssn label="ISSN" mandatory="{true}" />                <fieldset label="Notes">                    <text name="Notes" rows="1" class="fullwidth autoheight" />                    <help name="Notes" />                </fieldset>                <Lien />                <ProdFich />                <Statut />                <script type="text/javascript">ctrlInitialize("ControlsPeriodique");</script>            </case>                        <case test="rapport">                <AutTit />                <Date />                <fieldset label="Nombre de pages">                    <text name="Page" class="fullwidth mandatory" />                    <help name="Page" />                </fieldset>                <fieldset label="Edition">                    <div>                        <text name="Edit" value="{implode('/',(array)$Edit)}" rows="1" label="Editeur" class="fullwidth autoheight" />                        <help name="Edit" />                    </div>                    <div>                        <text name="Lieu" value="{implode('/',(array)$Lieu)}" rows="1" label="Lieu d'édition" class="fullwidth autoheight" />                        <help name="Lieu" />                    </div>    				<ColReed />                </fieldset>                <Periodique revMandatory="{false}" />                <IsbnIssn />                <fieldset label="Notes">                    <text name="Notes" rows="1" class="fullwidth autoheight" />                    <help name="Notes" />                </fieldset>                <ResuIndexation themeMandatory="{true}" />                <Lien mandatory="{true}" />                <ProdFich />                <Statut />                <script type="text/javascript">ctrlInitialize("ControlsRapport");</script>            </case>                        <case test="texte officiel">                <fieldset label="Nature du texte officiel" style="border: 1px solid red;">                    <fill values="$NatText"><radiolist name="NatText" src="new TextTable($this->path.'tables/nattext.txt')" class="mandatory" /></fill>                </fieldset>                <fieldset label="Titres du document et liens vers les versions électroniques">                    <div>                        <text name="Tit" rows="1" label="Titre" class="fullwidth autoheight mandatory" />                        <help name="Tit" />                    </div>                    <div>                        <text name="Lien" rows="2" label="Lien vers le document" class="fullwidth mandatory" />                        <help name="Lien" />                    </div>                    <div>                        <text name="Annexe" value="{implode('/',(array)$Annexe)}" rows="1" label="Titres des annexes" class="fullwidth autoheight" />                        <help name="Annexe" />                    </div>                    <div>                        <text name="LienAnne" value="{implode(' ; ',(array)$LienAnne)}" rows="2" label="Liens vers les annexes" class="fullwidth" />                        <help name="LienAnne" />                    </div>                </fieldset>                <fieldset label="Dates">                    <div>                        <text name="DateText" label="Date du texte officiel" class="fullwidth" />                        <help name="DateText" />                    </div>                    <div>                        <text name="DatePub" label="Date de publication du texte officiel" class="fullwidth" />                        <help name="DatePub" />                    </div>                    <div>                        <text name="DateVali" label="Date de fin de validité du texte officiel" class="fullwidth" />                        <help name="DateVali" />                    </div>                </fieldset>                <Periodique volExists="{false}" />                           <fieldset label="Numéro du texte officiel">                    <text name="NumTexOf" class="fullwidth" />                    <help name="NumTexOf" />                </fieldset>                <ResuIndexation themeMandatory="{true}" />                <ProdFich />                <Statut />                <script type="text/javascript">ctrlInitialize("ControlsTexteOfficiel");</script>            </case>                /* Modification d'une notice avec tous les champs */            <case test="allfields">                <fieldset label="Type de document">                    <fill values="$Type"><radiolist name="Type" src="new TextTable($this->path.'tables/type.txt')" /></fill>                </fieldset>                <fieldset label="Nature du texte officiel">                    <fill values="$NatText"><radiolist name="NatText" src="new TextTable($this->path.'tables/nattext.txt')" /></fill>                </fieldset>                <fieldset label="Auteurs">                    <text name="Aut" value="{implode('/',(array)$Aut)}" rows="1" class="fullwidth autoheight" />                    <help name="Aut" />                </fieldset>                <fieldset label="Titres du document et liens vers les versions électroniques">                    <div>                        <text name="Tit" rows="1" label="Titre du document" class="fullwidth autoheight" />                        <help name="Tit" />                    </div>                    <div>                        <text name="Lien" rows="1" label="Lien vers le document" class="fullwidth autoheight" />                        <help name="Lien" />                    </div>                            <div>                        <text name="Annexe" value="{implode('/',(array)$Annexe)}" rows="1" label="Titres des annexes" class="fullwidth autoheight" />                        <help name="Annexe" />                    </div>                    <div>                        <text name="LienAnne" value="{implode(' ; ',(array)$LienAnne)}" rows="1" label="Liens vers les annexes" class="fullwidth autoheight" />                        <help name="LienAnne" />                    </div>                            <div>                        <text name="NumTexOf" label="Numéro du texte officiel" class="fullwidth" />                        <help name="NumTexOf" />                    </div>                </fieldset>                <fieldset label="Spécialité du diplôme">                    <text name="DipSpe" rows="1" class="fullwidth autoheight" />                    <help name="DipSpe" />                </fieldset>                <Congres />                <fieldset label="Dates">                    <div>                        <text name="Date" label="Année du document ou de soutenance" class="fullwidth" />                        <help name="Date" />                    </div>                    <div>                        <text name="DateText" label="Date du texte officiel" class="fullwidth" />                        <help name="DateText" />                    </div>                    <div>                        <text name="DatePub" label="Date de publication du texte officiel" class="fullwidth" />                        <help name="DatePub" />                    </div>                    <div>                        <text name="DateVali" label="Date de fin de validité du texte officiel" class="fullwidth" />                        <help name="DateVali" />                    </div>                </fieldset>                <fieldset label="Mentions bibliographiques">                    <div>                        <text name="Page" label="Nombre de pages" class="fullwidth" />                        <help name="Page" />                    </div>                    <div>                        <text name="PdPf" label="Page de début et page de fin" class="fullwidth" />                        <help name="PdPf" />                    </div>                    <div>                        <text name="Notes" label="Notes " rows="1" class="fullwidth autoheight" />                        <help name="Notes" />                    </div>                </fieldset>                <fieldset label="Edition">                    <div>                        <text name="Edit" value="{implode('/',(array)$Edit)}" rows="1" label="Editeur(s)" class="fullwidth autoheight" />                        <help name="Edit" />                    </div>                    <div>                        <text name="Lieu" value="{implode('/',(array)$Lieu)}" rows="1" label="Lieu d'édition ou de soutenance" class="fullwidth autoheight" />                        <help name="Lieu" />                    </div>                    <ColReed />                </fieldset>                <IsbnIssn />                <fieldset label="Périodique">                    <div>                        <text name="Rev" label="Titre du périodique" rows="1" class="fullwidth autoheight" />                        <help name="Rev" />                    </div>                    <div>                        <text name="Vol" label="Volume" class="fullwidth" />                        <help name="Vol" />                    </div>                    <div>                        <text name="Num" label="Numéro" class="fullwidth" />                        <help name="Num" />                    </div>                    <div>                        <text name="ViePerio" label="Date de vie et de mort" class="fullwidth" />                        <help name="ViePerio" />                    </div>                    <div>                        <text name="EtatCol" label="Etat de la collection" value="{implode('/',(array)$EtatCol)}" rows="1" class="fullwidth autoheight" />                        <help name="EtatCol" />                    </div>                </fieldset>                <fieldset label="Résumé">                    <text name="Resu" rows="1" class="fullwidth autoheight" />                    <help name="Resu" />                </fieldset>                <fieldset label="Indexation">                    <div>                        <text name="Theme" rows="1" label="Thème" class="fullwidth autoheight" />                        <help name="Theme" />                    </div>                    <div>                        <text name="MotCle" value="{implode('/',(array)$MotCle)}" rows="1" label="Descripteurs" class="fullwidth autoheight" />                        <help name="MotCle" />                    </div>                    <div>                        <text name="Nomp" value="{implode('/',(array)$Nomp)}" rows="1" label="Noms propres" class="fullwidth autoheight" />                        <help name="Nomp" />                    </div>                    <div>                        <text name="CanDes" value="{implode('/',(array)$CanDes)}" rows="1" label="Candidats descripteurs" class="fullwidth autoheight" />                        <help name="CanDes" />                    </div>                </fieldset>                <Loc mandatory="{false}" />                <ProdFich mandatory="{false}" />                <Statut />                <script type="text/javascript">ctrlInitialize("Controls");</script>            </case>                        <default>                <p>La notice numéro $REF possède un type de document qui n'est pas géré : '$Type', impossible de l'afficher.</p>            </default>                  </switch>                <opt>            <fieldset label="Dates de création et de mise à jour de la notice">                <div><p>Création : $Creation</p></div>                <if test="{User::hasAccess('AdminBase')}">                    <div><p>Mise à jour : $LastUpdate<opt> par $LastAuthor</opt></p></div>                </if>                <else>                    <div><p>Mise à jour : $LastUpdate</p></div>                </else>            </fieldset>        </opt>                /* Boutons Enregistrer et Supprimer */        <div class="buttons">            <def name="deletelink" value="{Routing::linkFor('ConfirmDelete?REF='.$REF)}" />            <button test="{$REF!=0 AND User::hasAccess('AdminBase')}" type="button" onclick="window.location.replace('$deletelink');" class="reset">Supprimer</button>            <submit label="Enregistrer" class="submit" />        </div>        </form></div> /* class="texte" */