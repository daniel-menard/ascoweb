<h1>Import de fichiers dans la base</h1>
<p>
        Ce module permet d'importer un ou plusieurs fichiers dans la base 
        de données. Etablissez tout d'abord la liste des fichiers à importer en
        transférant chaque fichier de votre poste de travail au serveur. Si vous
        transférez un fichier erroné, utiliser le bouton supprimer qui figure 
        après son nom. Lancez l'import une fois que vous avez terminé.
</p>

<fieldset label="Liste des fichiers à importer dans la base">
    <ul>
        {echo "<?php global \$files ?>"}
        <if test="{count($files) == 0}">
            <li>
                Pour le moment, il n'y a aucun fichier à importer.
                Utilisez la zone ci-dessous pour choisir des fichiers à importer.
            </li>
        </if>
        <else>
            <loop on="{array($files)}" order="asc">
                <form method="post" class="form ">
                    <strong>$array.name</strong> ($array.size octets, envoyé au serveur le $array.time par <strong>$array.ident</strong>)
                    <submit label="Supprimer le fichier..." class="delete" />
                    <input type="hidden" name="delete" value="$array.key" />
                </form>
            </loop>
        </else>
    </ul>
</fieldset>

<opt>
    <fieldset label="Erreur" class="error">
        <ul>$error</ul>
    </fieldset>
</opt>

<form method="post" enctype="multipart/form-data" name="uploadForm">
    <fieldset label="Ajouter des fichiers">
        <div>
              Cliquez sur le bouton "Parcourir" pour choisir chacun des fichiers à importer puis
              cliquez sur le bouton "Envoyer au serveur" pour lancer le transfert de ces fichiers.<br />
              Recommencez l'opération si vous avez plus de trois fichiers à importer.
        </div>
        <div>
            <submit label="Envoyer au serveur..." style="float: right" onclick="getElementById('wait').style.display='';" />
            <loop on="{array(1, 2, 3)}" as="$num">
                <upload name="file$num" label="Fichier :" />
            </loop>
            <opt>
                <loop on="{array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)}" as="$num">
                    <upload name="file$num" label="Fichier :" />
                </loop>
            </opt>   
        </div>
    </fieldset>
    <div name="wait" style="display: none; background-color: #eee; position: absolute; top: 40%; left: 30%; width: 40%; border: 5px ridge #008; padding: 1em; text-align: center;">
        <img id="progressbar" src="/images/progressbar2.gif" /><br />
        Veuillez patienter pendant l'envoi des fichiers au serveur...
    </div>
</form>

<if test="User::hasAccess('AdminBase')">
    <form method="post" class="form ">
        <fieldset label="Lancer l'import">
            <div>
                <div>
                    <radio name="now" label="maintenant" value="1" checked="checked" />
                </div>
                <div>
                    <radio name="now" label="plus tard" value="0" checked="checked" />
                    <textbox name="delay" size="30" onclick="document.getElementById('after').checked='checked';" onfocus="document.getElementById('after').checked='checked';" />
                    <label>saisir le jour et l'heure sous la forme JJ/MM/AAAA hh:mm:ss</label>
                </div>
                <submit name="import" label="Lancer l*****import..." style="float: right;" />
            </div>
        </fieldset>
    </form>
</if>