<ul class="fulllist" start="{$this->selection->searchInfo('rank')}">
    <loop on="{$this->selection}" as="$rank, $record">
        <li class="record">

            /* Numéro de référence de la notice, utilisé pour l'ajout/suppression de plusieurs notices dans le/du panier */
            <hidden name="item" value="$REF" />

            /* Barre de liens de la notice */
            <span style="text-align: right;margin: 0;padding:0;">
            
                /* Numéro de la réponse */
                <span test="{$this->selection->count()>1}" style="float: left; padding-right: 1em;">{$this->selection->searchInfo('rank')}.</span>
                
                /* Bouton Ajouter ou Supprimer dans le/du panier */
                <span style="float: left">
                    <if test="{User::hasAccess('AdminBase,EditBase')}">
                        <if test="{!Config::get('incart',false)}">
                            <a class="addtocart" href="/AscoCart/Add?item=$REF">
                                <img src="/css/ascodocpsy/cart_add.png" alt="Ajouter au panier" />
                            </a>
                        </if>
                        <else>
                            <a href="/AscoCart/Remove?item=$REF">
                                <img src="/css/ascodocpsy/cart_delete.png" alt="Supprimer du panier" />
                            </a>
                        </else>
                    </if>                
                </span>                
                
                /* Boutons de la notice */ 
                <span class="recordbuttons" style="float: right">
                
                    /* Bouton "modifier" */
                    <if test="{$this->hasEditRight()}">
                        <a href="Load?REF=$REF">
                            <img src="/css/ascodocpsy/application_form_edit.png" align="top" alt="Modifier la notice" />
                            Modifier
                        </a>
                    </if>
                </span>
            </span>

            /* Affiche les informations appropriées en fonction du type de document et des drois utilisateurs */
            <switch test="{strtolower($Type)}">
            
                <case test="article">
                    <TDTA />
                    <row label="Source">$Rev<Localisation /><opt> $Presentation</opt><opt>, vol $Vol</opt><opt>, n°$Num</opt>, p. $PdPf</row>
                    <opt><row label="Notes">$Notes</row></opt>
                    <MTCNR />
                    <opt><row test="{User::hasAccess('AdminBase,EditBase')}" label="Producteur">$ProdFich</row></opt>
                </case>
                
                <case test="congrès">
                    <TDTA />
                    <opt><row label="Congrès"><opt>$CongrTit, </opt><opt>$CongrDat, </opt><opt>n°$CongrNum, </opt><opt>$CongrLie</opt></row></opt>
                    <opt><row label="Source"><opt>$Lieu : </opt><opt>$Edit, </opt><opt>$Reed, </opt>$Page</row></opt>
                    <opt><row label="Collection">$Col</row></opt>
                    <opt><row label="Notes">$Notes</row></opt>
                    <MTCNR />
                    <Isbn />
                    <if test="{User::hasAccess('AdminBase,EditBase')}">
                        <opt><row label="Localisation">$Loc</row></opt>
                        <opt><row label="Producteur">$ProdFich</row></opt>
                    </if>
                </case>
                
                <case test="livre">
                    <TDTA />
                    <opt><row label="Source"><opt>$Lieu : </opt><opt>$Edit, </opt><opt>$Reed, </opt>$Page</row></opt>
                    <opt><row label="Collection">$Col</row></opt>
                    <opt><row label="Notes">$Notes</row></opt>
                    <MTCNR />
                    <Isbn />
                    <if test="{User::hasAccess('AdminBase,EditBase')}">
                        <opt><row label="Localisation">$Loc</row></opt>
                        <opt><row label="Producteur">$ProdFich</row></opt>
                    </if>
                </case>
                
                <case test="{strtolower($Type)=='mémoire' || strtolower($Type)=='thèse'}">
                    <TDTA />
                    <if test="{User::hasAccess('AdminBase,EditBase')}">
                        <opt><row>$DipSpe</row></opt>
                        <opt><row label="Source"><opt>$Lieu, </opt><opt>$Edit, </opt>$Page</row></opt>
                    </if>
                    <else>
                        <opt><row label="Thèse"><opt>$DipSpe, </opt><opt>$Lieu, </opt><opt>$Edit, </opt>$Page</row></opt>
                    </else>
                    <opt><row label="Notes">$Notes</row></opt>
                    <MTCNR />
                    <if test="{User::hasAccess('AdminBase,EditBase')}">
                        <opt><row label="Localisation">$Loc</row></opt>
                        <opt><row label="Producteur">$ProdFich</row></opt>
                    </if>
                </case>
                
                <case test="périodique">
                    <div class="row"><div>$Type<opt>, $ViePerio</opt></div></div>
                    <div class="row"><div>$Rev<opt> $Presentation</opt><opt>, {implode(' / ',(array)$IsbnIssn)}</opt></div></div>
                    <opt><row label="Localisation">$EtatCol</row></opt>
                    <opt><row label="Notes">$Notes</row></opt>
                </case>
                
                <case test="rapport">
                    <TDTA />
                    <opt><row label="Source"><opt>$Lieu : </opt><opt>$Edit, </opt><opt>$Reed, </opt><opt>$PageEdit</opt></row></opt>                        
                    <opt><row label="Source">$Rev<Localisation /><opt> $Presentation</opt><opt>, vol $Vol</opt><opt>, n°$Num</opt><opt>, $PageRev</opt></row></opt>
                    <opt><row label="Collection">$Col</row></opt>
                    <opt><row label="Notes">$Notes</row></opt>
                    <MTCNR />
                    <Isbn />
                    <opt><row test="{User::hasAccess('AdminBase,EditBase')}" label="Producteur">$ProdFich</row></opt>
                </case>
                
                <case test="texte officiel">
                    <row>$Type</row>
                    <opt><row label="Titre"><Tit /><opt> ; $Annexe</opt></row></opt>
                    <opt><row test="{! User::hasAccess('AdminBase,EditBase')}" label="Source">$Rev du $DatePub, n°$Num</row></opt>
                    <opt><row test="{User::hasAccess('AdminBase,EditBase')}" label="Source">$Rev<opt>, n°$Num</opt><opt> du $DatePub</opt></row></opt>
                    <MTCNR />
                    <opt><row test="{User::hasAccess('AdminBase,EditBase')}" label="Producteur">$ProdFich</row></opt>
                </case>
            </switch>
            
            <opt><row test="{User::hasAccess('AdminBase')}" label="Mise à jour">$LastUpdate<opt> par $LastAuthor</opt></row></opt>
        </li>
    </loop>
</ul>