<slot name="menubase">
	<div test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" class="buttons menubase">
		<ul>
			<li><a href="/base/replaceform?_equation={urlencode($this-&gt;equation)}">Chercher/remplacer dans ces notices...</a></li>
	    	<li><a test="{User::hasAccess('AdminBase')}" href="/base/delete?_equation={urlencode($this->equation)}">Supprimer ces notices</a></li>
	    </ul>
	</div>    
</slot>

<hr />

<div class="texte">

<opt>
	<div>
	    {$this->getResNavigation(10, '&lt;', '&gt;', '&lt;&lt;', '&gt;&gt;')}
	    <hr />
	</div>
</opt>

<div test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" class="buttons">
	<if test="{!Config::get('incart',false)}">
	    <submit name="btnadd" class="addall" label="Ajouter les notices au panier" />
	</if>
	<else>
		<submit name="btnremove" class="removeall" label="Supprimer les notices du panier" />
	</else>
</div>    

<hr />

<ul class="shortlist">
    <loop on="{$this->selection}" as="$rank, $record">
        <li class="record">

            <if test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}">
                <if test="{!Config::get('incart',false)}">
                    <a class="addtocart" href="/ascocart/add?category={Utils::convertString($Type,'lower')}&amp;item=$REF"><span>Ajouter au panier</span></a>
                </if>
                <else>
                    <a class="removefromcart" href="/ascocart/remove?category={Utils::convertString($Type,'lower')}&amp;item=$REF"><span>Supprimer du panier</span></a>
                </else>
            </if>                

            <a class="fullrecord" href="/base/show?REF=$REF" title="Voir la notice complète"><span>Voir la notice complète</span></a>
            
            <if test="{$this->hasEditRight()}">
                <a class="loadrecord" href="/base/load?REF=$REF" title="Modifier la notice"><span>Modifier la notice</span></a>
            </if>
            
            <hidden name="item" value="$REF" />
            <hidden name="category" value="{Utils::convertString($Type,'lower')}" />
/*            <hidden name="toadd" value="{addslashes(urlencode(serialize(array('item'=>$REF,'category'=>Utils::convertString($Type,'lower')))))}" />*/
            
            /* affiche les informations appropriées en fonction du type de document et des drois utilisateurs */
            <switch test="$Type">
            
                <case test="Article">
                    <TDTA />
                    <row test="{! (User::hasAccess('AdminBase') || User::hasAccess('EditBase'))}" label="Périodique">$Rev<opt>, vol $Vol</opt><opt>, n°$Num</opt>, p. $PdPf</row>
                    <row test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" label="Périodique">$Rev<Localisation /><opt> $Presentation</opt><opt>, vol $Vol</opt><opt>, n°$Num</opt>, p. $PdPf</row>
                </case>
                
                <case test="Congrès">
                    <TDTA />
                    <opt><row label="Congrès"><opt>$CongrTit, </opt><opt>$CongrDat, </opt><opt>n°$CongrNum, </opt><opt>$CongrLie, </opt><opt>$Lieu : </opt><opt>$Edit, </opt><opt>$Reed, </opt>$Page</row></opt>
                    <opt><row test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" label="Localisation">$Loc</row></opt>
                </case>
                
                <case test="Livre">
                    <TDTA />
                    <opt><row label="Editeur"><opt>$Lieu : </opt><opt>$Edit, </opt><opt>$Reed, </opt>$Page</row></opt>
                    <opt><row test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" label="Localisation">$Loc</row></opt>
                </case>
                
                <case test="{$Type=='Mémoire' || $Type=='Thèse'}">
                    <TDTA />
                    <opt><row><opt>$DipSpe, </opt><opt>$Lieu, </opt><opt>$Edit, </opt>$Page</row></opt>
                    <opt><row test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" label="Localisation">$Loc</row></opt>
                </case>
                
                <case test="Périodique">
                    <row>$Type<opt>, $ViePerio</opt></row>
                    <row>$Rev<opt> $Presentation</opt><opt>, $IsbnIssn</opt></row>
                    <opt><row>$Notes</row></opt>
                </case>
                
                <case test="Rapport">
                    <TDTA />
                    <opt><row label="Editeur"><opt>$Lieu : </opt><opt>$Edit, </opt><opt>$Reed, </opt>$PageEdit</row></opt>
                    <opt><row test="{! (User::hasAccess('AdminBase') || User::hasAccess('EditBase'))}" label="Périodique"><opt>$Rev</opt><opt>, vol $Vol</opt><opt>, n°$Num</opt><opt>, $PageRev</opt></row></opt>
                    <opt><row test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" label="Périodique"><opt>$Rev</opt>
                    <Localisation />
                    <opt> $Presentation</opt><opt>, vol $Vol</opt><opt>, n°$Num</opt>, $PageRev</row></opt>
                </case>
                
                <case test="Texte officiel">
                    <row>$Type</row>                       
                    <row test="{! (User::hasAccess('AdminBase') || User::hasAccess('EditBase'))}" label="Titre"><Tit /><opt> / $Annexe</opt></row>
                    <row test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" label="Titre"><Tit /><opt> ; $Annexe</opt></row>
                    <opt><row test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" label="Périodique">$Rev<opt> du $DatePub</opt></row></opt>
                </case>
                <default>
                    <p>La notice numéro $REF possède un type de document qui n'est pas géré : '$Type', impossible de l'afficher.</p>
                </default>
                
            </switch>
            <slot name="xapianinfo" />
        </li>
        <hr />
    </loop>
</ul>

<div test="{User::hasAccess('AdminBase') || User::hasAccess('EditBase')}" class="buttons">
	<if test="{!Config::get('incart',false)}">
	    <submit name="btnadd" class="addall" label="Ajouter les notices au panier" />
	</if>
	<else>
		<submit name="btnremove" class="removeall" label="Supprimer les notices du panier" />
	</else>
</div>    

<opt>
	<div>
	    <hr />
	    {$this->getResNavigation(10, '&lt;', '&gt;', '&lt;&lt;', '&gt;&gt;')}
	</div>
</opt>

</div>