/* Template pour afficher un <label> et une <div class="row"> dans une autre <div class="field"> */
<template match="//row" label="" class="" value="" test="">
    <div test="$test" class="row $class">
        <label test="'$label'" class="field $class">$label</label>
        <div class="field $class">
            {select('string(@value)')}{select('.//node()')}{select('@*')}
        </div>
    </div>
</template>


/* TODO : factoriser Type, Date, Tit et Notes, MotsCle, CanDes, Resu */

<if test="User::hasAccess('AdminBase')">        /* Administrateur */
    <h1>Base documentaire - Visualisation - Accès administrateur</h1>
</if>
<elseif test="User::hasAccess('EditBase')">     /* Membre du GIP */
    <h1>Base documentaire - Visualisation - Accès membre du GIP</h1>
</elseif>
<else>
    <h1>Base documentaire - Visualisation - Accès public</h1>
</else>


<p test="User::hasAccess('AdminBase') || User::hasAccess('EditBase')">
    Equation : $equation
</p>

/* Boutons supplémentaires pour les membres du GIP's et les admin (actions à effectuer sur les notices sélectionnées) */
<form if="User::hasAccess('AdminBase') || User::hasAccess('EditBase')" action="/base/addToCart" method="post" name="answers">

    <ul class="fulllist">
        <loop on="$selection" as="$rank, $record">
            <li class="record">
            
                <if test="User::hasAccess('AdminBase') || $ShowModifyBtn">
                    <input type="hidden" name="art" value="$REF" />
                    <a class="loadrecord" href="load?ref=$REF" title="Modifier la notice"><span>Modifier la notice</span></a>
                </if>
            
                /* affiche les informations appropriées en fonction du type de document et des drois utilisateurs */
                <switch test="$type">
                
                    <case test="'Article'">        
                        <row >$Type, $Date</row>
                        <row label="Titre">$Tit</row>
                        <opt><row label="Auteur(s)">$Aut</row></opt>
                        <row label="Périodique">$Rev</row>
                        <opt><row><opt>vol $Vol, </opt><opt>n°$Num, </opt>p. $PdPf</row></opt>
                        <opt><row label="Notes">$Notes</row></opt>
                        <opt><row label="Descripteurs SantéPsy">$MotCle<opt>/$Theme</opt></row></opt>
                        <opt><row label="Autres descripteurs">$CanDes<opt>/$Nomp</opt></row></opt>
                        <opt><row label="Résumé">$Resu</row></opt>
                    </case>
                    
                    <case test="'Congrès'">
                        <row >$Type, $Date</row>
                        <row label="Titre">$Tit</row>
                        <opt><row label="Auteur(s)">$Aut</row></opt>
                        <opt><row label="Congrès"><opt>$CongrTit, </opt><opt>$CongrDat, </opt><opt>n°$CongrNum, </opt><opt>$CongrLie</opt></row></opt>
                        <opt><row label="Editeur"><opt>$Lieu : </opt><opt>$Edit, </opt><opt>$Reed, </opt>$Page</row></opt>
                        <opt><row label="Collection">$Col</row></opt>
                        <opt><row label="Notes">$Notes</row></opt>
                        <opt><row label="Descripteurs SantéPsy">$MotCle<opt>/$Theme</opt></row></opt>
                        <opt><row label="Autres descripteurs">$CanDes<opt>/$Nomp</opt></row></opt>
                        <opt><row label="Résumé">$Resu</row></opt>
                        <opt><row label="ISBN">$IsbnIssn</row></opt>
                    </case>
                    
                    <case test="'Livre'">
                        <row >$Type, $Date</row>
                        <row label="Titre">$Tit</row>
                        <opt><row label="Auteur(s)">$Aut</row></opt>
                        <opt><row label="Editeur"><opt>$Lieu : </opt><opt>$Edit, </opt><opt>$Reed, </opt>$Page</row></opt>
                        <opt><row label="Collection">$Col</row></opt>
                        <opt><row label="Notes">$Notes</row></opt>
                        <opt><row label="Descripteurs SantéPsy">$MotCle<opt>/$Theme</opt></row></opt>
                        <opt><row label="Autres descripteurs">$CanDes<opt>/$Nomp</opt></row></opt>
                        <opt><row label="Résumé">$Resu</row></opt>
                        <opt><row label="ISBN">$IsbnIssn</row></opt>
                    </case>
                    
                    <case test="$type=='Mémoire' || $type=='Thèse'">
                        <row >$Type, $Date</row>
                        <row label="Titre">$Tit</row>
                        <opt><row label="Auteur(s)">$Aut</row></opt>
                        <opt><row label="Thèse"><opt>[DipSpe], </opt><opt>[Lieu], </opt><opt>[Edit], </opt>[Page]</row></opt>
                        <opt><row label="Notes">$Notes</row></opt>
                        <opt><row label="Descripteurs SantéPsy">$MotCle<opt>/$Theme</opt></row></opt>
                        <opt><row label="Autres descripteurs">$CanDes<opt>/$Nomp</opt></row></opt>
                        <opt><row label="Résumé">$Resu</row></opt>
                    </case>
                    
                    <case test="'Rapport'">
                        <row >$Type, $Date</row>
                        <row label="Titre">$Tit</row>
                        <opt><row label="Auteur(s)">$Aut</row></opt>
                        <opt><row label="Editeur"><opt>$Lieu : </opt><opt>$Edit, </opt><opt>$Reed, </opt>$Page</row></opt>
                        <opt><row label="Périodique"><opt>$Rev</opt><opt>, vol $Vol</opt><opt>, n°$Num</opt><opt>, $PageRev</opt></row></opt>
                        <opt><row label="Collection">$Col</row></opt>
                        <opt><row label="Notes">$Notes</row></opt>
                        <opt><row label="Descripteurs SantéPsy">$MotCle<opt>/$Theme</opt></row></opt>
                        <opt><row label="Autres descripteurs">$CanDes<opt>/$Nomp</opt></row></opt>
                        <opt><row label="Résumé">$Resu</row></opt>
                        <opt><row label="ISBN">$IsbnIssn</row></opt>
                    </case>
                    
                    <case test="'Texte officiel'">
                        <row>$Type</row>
                        <opt><row label="Titre">$Tit<opt> ; $Annexe</opt></row></opt>
                        <opt><row label="Source">$Rev du $DatePub, n°$Num</row></opt>
                        <opt><row label="Descripteurs SantéPsy">$MotCle<opt>/$Theme</opt></row></opt>
                        <opt><row label="Autres descripteurs">$CanDes<opt>/$Nomp</opt></row></opt>
                        <opt><row label="Résumé">$Resu</row></opt>
                    </case>
                </switch>
            </li>
        </loop>
    </ul>

    <div test="User::hasAccess('AdminBase') || User::hasAccess('EditBase')" class="buttons">
        <submit name="btnadd" label="Ajouter les notices au panier" />
    </div>
</form>